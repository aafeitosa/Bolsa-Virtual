<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/templateComMenu.xhtml">

	<ui:define name="content">

		<p:fieldset
			legend="#{msgs.mantem} #{msgs.rodadas} : #{rodadaFormBack.rodada.numero}"
			style="margin-bottom:20px">

			<h:form id="rodadasForm">

				<p:growl id="msgs" showDetail="true" sticky="true" />

				<p:tabView id="tab-view-rodadas" activeIndex="0" dynamic="false"
					cache="false">

					<p:tab id="tab0-rodada" title="#{msgs.rodada}"
						disabled="#{permissao.disabled('RODADA_EDITAR_ABA_RODADA')}">

						<p:panelGrid columns="2">

							<p:panelGrid columns="3">

								<p:outputLabel for="grupo" value="#{msgs.grupo}:" />
								<p:inputText id="grupo"
									value="#{rodadaFormBack.rodada.grupo.nome}" disabled="true" />
								<p:message for="grupo" />

								<p:outputLabel for="dataInicio" value="#{msgs.dataInicio}:" />
								<p:calendar id="dataInicio" disabled="true"
									value="#{rodadaFormBack.rodada.dataInicio}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm"
										timeZone="#{rodadaFormBack.timeZone}" />
								</p:calendar>
								<p:message for="dataInicio" />

								<p:outputLabel for="numero" value="#{msgs.numero}:" />
								<p:inputText id="numero" value="#{rodadaFormBack.rodada.numero}"
									maxlength="4" disabled="true" />
								<p:message for="numero" />

								<p:outputLabel for="valor" value="#{msgs.valor}:" />
								<p:inputText id="valor" value="#{rodadaFormBack.rodada.valor}"
									maxlength="10" />
								<p:message for="valor" />

								<p:outputLabel for="numeroMaximoInvestimentos"
									value="#{msgs.numeroMaximoInvestimentos}:" />
								<p:inputText id="numeroMaximoInvestimentos"
									value="#{rodadaFormBack.rodada.numeroMaximoInvestimentos}"
									maxlength="10" />
								<p:message for="numeroMaximoInvestimentos" />

								<p:outputLabel for="encerrada" value="#{msgs.encerrada}:" />
								<p:selectBooleanCheckbox id="encerrada"
									value="#{rodadaFormBack.rodada.encerrada}">
									<p:ajax update="dataFim" />
								</p:selectBooleanCheckbox>
								<p:message for="valor" />

								<p:outputLabel for="dataFim" value="#{msgs.dataFim}:" />
								<p:calendar id="dataFim"
									value="#{rodadaFormBack.rodada.dataFim}" disabled="true">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm"
										timeZone="#{rodadaFormBack.timeZone}" />
								</p:calendar>
								<p:message for="dataFim" />



							</p:panelGrid>
							
							<p:dataTable var="variacao" value="#{rodadaFormBack.variacoes}" styleClass="variacoes"
								rowIndexVar="rowId" editable="true" border="1" cellpadding="2"
								editMode="cell" cellspacing="0" id="variacoesTable" >

								<p:ajax event="cellEdit" listener="#{rodadaFormBack.onCellEdit}"
									update=":rodadasForm:msgs" />

								<p:column>
									<f:facet name="header">
										<h:outputText value="#{msgs.ramo_atividade}" />
									</f:facet>
									<h:outputText value="#{variacao.ramoAtividade.nome}" />
								</p:column>

								<p:column>
									<f:facet name="header">
										<h:outputText value="#{msgs.variacao}" />
									</f:facet>

									<p:cellEditor>
										<f:facet name="output">
											<h:outputText value="#{variacao.variacao} %" />
										</f:facet>
										<f:facet name="input">
											<h:inputText value="#{variacao.variacao}" />
										</f:facet>
									</p:cellEditor>

									<!-- 									<p:cellEditor> -->
									<!-- 										<f:facet name="output"> -->
									<!-- 											<h:outputText id="output_#{rowId}" -->
									<!-- 											value="#{variacao.variacao} %" /> -->
									<!-- 										</f:facet> -->
									<!-- 										<f:facet name="input"> -->
									<!-- 											<h:inputHidden id="slid_#{rowId}" value="#{variacao.variacao}" /> -->
									<!-- 										<p:slider for="slid_#{rowId}" display="output_#{rowId}" -->
									<!-- 											style="width: 200px" displayTemplate="{value}%" -->
									<!-- 											minValue="-10" maxValue="10" /> -->
									<!-- 										</f:facet> -->
									<!-- 									</p:cellEditor> -->

									<!-- 									<h:panelGrid columns="1" style="margin-bottom: 10px"> -->
									<!-- 										<h:outputText id="output_#{rowId}" -->
									<!-- 											value="#{variacao.variacao} %" /> -->
									<!-- 										<h:inputHidden id="slid_#{rowId}" value="#{variacao.variacao}" /> -->
									<!-- 										<p:slider for="slid_#{rowId}" display="output_#{rowId}" -->
									<!-- 											style="width: 200px" displayTemplate="{value}%" -->
									<!-- 											minValue="-10" maxValue="10" /> -->
									<!-- 									</h:panelGrid> -->
								</p:column>

							</p:dataTable>

						</p:panelGrid>
					</p:tab>

					<p:tab id="tab0-resultados" title="#{msgs.resultados}"
						disabled="#{permissao.disabled('RODADA_EDITAR_ABA_RESULTADOS')}">

						<p:dataTable var="resultado" value="#{rodadaFormBack.resultados}"
							border="1" cellpadding="2" cellspacing="0" id="resultadosTable">

							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs.empresa}" />
								</f:facet>
								<h:outputText value="#{resultado.empresa.nome}" />
							</p:column>

							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs.resultado}" />
								</f:facet>
								<h:outputText value="#{resultado.resultado}" />
							</p:column>

						</p:dataTable>

					</p:tab>

				</p:tabView>

				<p:commandButton value="#{msgs.salvar}"
					rendered="#{permissao.rendered('RODADA_EDITAR_SALVAR')}"
					action="#{rodadaFormBack.salva}" ajax="false">
					<f:param name="first" value="#{rodadaFormBack.first}" />
					<f:param name="nro" value="#{rodadaFormBack.nroRegistrosPorPagina}" />
				</p:commandButton>

				<p:commandButton value="#{msgs.voltar}"
					action="#{rodadaFormBack.listagem}" ajax="false">
					<f:param name="first" value="#{rodadaFormBack.first}" />
					<f:param name="nro" value="#{rodadaFormBack.nroRegistrosPorPagina}" />
				</p:commandButton>

			</h:form>
		</p:fieldset>
	</ui:define>

</ui:composition>
